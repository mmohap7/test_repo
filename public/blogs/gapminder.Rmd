---
title: "GAPMINDER ANALYSIS"
output: html_document
slug: gapminder
---

```{r setup, include=FALSE,message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## EXPLORING GAPMINDER DATASET

Founded in Stockholm by Ola Rosling, Anna Rosling RÃ¶nnlund and Hans Rosling, GapMinder is a non-profit venture promoting sustainable global development and  achievement of the United Nations Millennium Development Goals. It seeks to  increase the use and understanding of statistics about social, economic, and
environmental development at local, national, and global levels.

It has over **200** indicators for all **192** United Nations Member countries.



```{r gapminder,echo=FALSE,message=FALSE}
#loading important packages

#ggplot2, dplyr, and all the other tidyverse packages
library(tidyverse)  

#gapminder dataset
library(gapminder) 

#for finding project files in current working directory
library(here)

```

```{r}
#gives us valuable information for initial exploratory data analysis
glimpse(gapminder)

# look at the first 20 rows of the dataframe
head(gapminder, 20) 


```

### INDIA AND ASIA - OVER THE YEARS


```{r}
# filtering 'India' from gapminder dataset
country_data <- gapminder %>% 
            filter(country == "India") 

#filtering 'Asia' from gapminder dataset, this gives us all Asian countries
continent_data <- gapminder %>% 
            filter(continent == "Asia")
```


```{r, india-lifeExp-interactive-plot}
# Libraries

#plotly for making our graph interactive
library(plotly)

#hrbrthemes for amazing themes
library(hrbrthemes)



# Area chart
p <- country_data %>%
  ggplot( aes(x=year, y=lifeExp)) +
    geom_area(fill="#FFA500", alpha=0.5) +
    geom_line(color="#69b3a2") +
    ylab("Life Expectancy in India") +
    theme_ipsum()

# Turn it interactive with ggplotly
p <- ggplotly(p)
p

```



### LIFE EXPECTANCY VS GDP OF ASIAN COUNTRIES

```{r,warning=FALSE,message=FALSE,results=FALSE}

# Libraries
library(ggplot2)
library(dplyr)
library(hrbrthemes)
library(viridis)

# The dataset is provided in the gapminder library
library(gapminder)
data <- gapminder %>% filter(year=="2007") %>% dplyr::select(-year)

# Most basic bubble plot
q<-data %>% filter(continent=="Asia") %>%
  arrange(desc(pop)) %>%
  mutate(country = factor(country,country)) %>%
  ggplot(aes(x=gdpPercap, y=lifeExp, size=pop, fill=country)) +
    geom_point(alpha=0.5, shape=21, color="black") +
    scale_size(range = c(.1, 24), name="Population (M)") +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum_pub() +
    theme(legend.position="bottom") +
    ylab("Life Expectancy") +
    xlab("Gdp per Capita") +
    theme(legend.position = "none")
```

```{r,warning=FALSE,message=FALSE,echo=FALSE}
q <- ggplotly(q)
q
```


```{r,warning=FALSE,message=FALSE}
data(gapminder, package = "gapminder")
plotdata <- gapminder %>%
  filter(year == 2007) %>%
  rename(
         value = pop) %>%
  mutate(region = tolower(country)) 



library(choroplethr)

p<-country_choropleth(plotdata,aes(x=long, y=lat, size=pop, fill=country),
                   num_colors=9) +
  scale_fill_brewer(palette="YlOrRd") +
  labs(title = "Population by country",
       subtitle = "Gapminder 2007 data",
       caption = "source: https://www.gapminder.org",
       fill = "Population") +theme_ipsum()

p <- ggplotly(p)
p
```





```{r,message=FALSE}
 plot1<- ggplot(data = country_data, mapping = aes(x = year, y = lifeExp))+
   geom_point() +
   geom_smooth(se = FALSE) + 
   labs(title = "Life Expectancy in India over the years",
       x = "Year",
       y = "Life Expectancy") +
   NULL


print(plot1)
```


```{r,message=FALSE}
 ggplot(data = continent_data , mapping = aes(x = year , y = lifeExp , colour=country ))+
  geom_point() + 
  geom_smooth(se = FALSE) +
   NULL
```
```{r,message=FALSE}
 ggplot(data = gapminder , mapping = aes(x = year , y = lifeExp , colour= continent))+
  geom_point() + 
 geom_smooth(se = FALSE) +
   facet_wrap(~continent) +
 theme(legend.position="none")
```
Given these trends, what can you say about life expectancy since 1952? Again, don't just say what's happening in the graph. Tell some sort of story and speculate about the differences in the patterns.

> Life Expectancies in:

> * *Africa* : increased significantly since 1952 even though when compared to other continents life expectancy remained significantly lower.The reason could be that the effects of globalisation and improvement in healthcare facilities were more prominent in continents such as Americas and Europe when compared to Africa.
> * *America* : America already had a higher life expectancy when compared to Africa and Asia. With signifancts improvements in medical field and introduction of vaccines and disease eradication initiatives(example, polio eradiaction initiative was introduced in 1980) , the average life expectancy is seen to increase by almost 20+ years from 1952 to 2000 in Americas.
> * *Asia* : Asia also saw a significant increase in life expectancy ranging from 45+ in 1952 to almost 70 in 2000. Even though the curve isn't as steep as that of America, significant changes in lifestyle and healthcare have contributed to this growth. Also, with a large proportion of **developing** countries in Asia facing the problem of overpopulation and shortage of healthcare facilities, the life expectancy growth isn't at par with continents with large numbers of **developed** countries such as **Europe** and **America** .
> * *Europe* : With already a high life expectancy (second only to Oceania) in 1952,Europe also saw a significant rise in life expectancy to almost 80 years in 2000. Since Europe has a large proportion of countries which were industrialised significantly early when compared to countries in continents, this could lead to higher average life expectancy in Europe in 1952.
> * *Oceania* : Oceania had the highest life expectancy in 1952 when compared to other continents and the same trend continued for in the year 2000 as well. The reason for this could lie in the fact the oceania comprises of significantly fewer countires and population when compared to other continents.



